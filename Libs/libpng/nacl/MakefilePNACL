# Copyright (c) 2013 The Chromium Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

# GNU Makefile based on shared rules provided by the Native Client SDK.
# See README.Makefiles for more details.
VALID_TOOLCHAINS := pnacl
NACL_ARCH:=x86_64
##NACL_ARCH:=x86_32
NACL_SDK_ROOT ?= $(abspath $(CURDIR)/../../../../pepper_31/)
include $(NACL_SDK_ROOT)/tools/common.mk

BASE_CFLAGS:=-Werror -Wno-write-strings -Wno-trigraphs


SOURCE_DIRS := ../src
INCLUDE_DIRS := ../include/libpng


SEARCH_WILDCARDS := $(addsuffix /*.c,$(SOURCE_DIRS)) 
override COMPILE_FLAGS += -pipe -Werror -Wno-write-strings -Wno-trigraphs -funroll-loops -fomit-frame-pointer 
override BUILD_FLAGS += -D__DAVAENGINE_NACL__  -Wno-deprecated 

TARGET = png
CFLAGS = $(BUILD_FLAGS) $(COMPILE_FLAGS) $(addprefix -I, $(INCLUDE_DIRS))
SOURCES = $(wildcard $(SEARCH_WILDCARDS))


# Build rules generated by macros from common.mk:

$(foreach src,$(SOURCES),$(eval $(call COMPILE_RULE,$(src),$(CFLAGS))))

ifeq ($(CONFIG),Release)
$(eval $(call LIB_RULE,$(TARGET)_unstripped,$(SOURCES),$(LIBS),$(DEPS)))
else
$(eval $(call LIB_RULE,$(TARGET),$(SOURCES),$(LIBS),$(DEPS)))
endif



